<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Live countdown to Friday. Resets every Saturday at 12:01 AM." />
  <title>COUNTDOWN TO FRIDAY</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet" />

  <link rel="stylesheet" href="styles.css" />
  <script>
    // Redirect to community board on Fridays (12:00 AM – 11:59 PM)
    if (new Date().getDay() === 5) {
      location.replace('community.html');
    }
  </script>
</head>
<body>

  <!-- Particle background -->
  <canvas id="particles"></canvas>

  <!-- CRT scanline overlay -->
  <div class="scanlines"></div>

  <main class="container">

    <!-- Header -->
    <header class="header">
      <div class="badge" id="badge">LIVE</div>
      <h1 id="headline">COUNTDOWN TO FRIDAY</h1>
      <div class="terminal-line">
        <span class="terminal-prompt">&gt;_</span>
        <span id="terminal-text"></span><span class="cursor-blink">█</span>
      </div>
    </header>

    <!-- Clock -->
    <div class="clock-grid" id="countdown-container">

      <div class="clock-unit">
        <div class="digit-display">
          <span class="ghost">88</span>
          <span class="digit" id="days-val">00</span>
        </div>
        <span class="unit-label">Days</span>
      </div>

      <div class="clock-divider">
        <span class="dot"></span>
        <span class="dot"></span>
      </div>

      <div class="clock-unit">
        <div class="digit-display">
          <span class="ghost">88</span>
          <span class="digit" id="hours-val">00</span>
        </div>
        <span class="unit-label">Hours</span>
      </div>

      <div class="clock-divider">
        <span class="dot"></span>
        <span class="dot"></span>
      </div>

      <div class="clock-unit">
        <div class="digit-display">
          <span class="ghost">88</span>
          <span class="digit" id="minutes-val">00</span>
        </div>
        <span class="unit-label">Minutes</span>
      </div>

      <div class="clock-divider">
        <span class="dot"></span>
        <span class="dot"></span>
      </div>

      <div class="clock-unit">
        <div class="digit-display">
          <span class="ghost">88</span>
          <span class="digit" id="seconds-val">00</span>
        </div>
        <span class="unit-label">Seconds</span>
      </div>

    </div>

    <!-- Watch Live -->
    <a href="stream.html" class="watch-live-btn">
      <span class="wl-dot"></span>▶ WATCH LIVE
    </a>

    <!-- Progress bar -->
    <section class="progress-section">
      <div class="progress-bar">
        <div class="progress-fill" id="progress-fill"></div>
      </div>
      <p class="progress-label" id="progress-label">0.0% OF THE WEEK GONE · HANG TIGHT</p>
    </section>

    <!-- System readout -->
    <div class="sys-readout">
      <span class="sys-item"><span class="sys-key">SYS_TIME</span><span class="sys-val" id="utc-time">--:--:--Z</span></span>
      <span class="sys-sep">·</span>
      <span class="sys-item"><span class="sys-key">DATE</span><span class="sys-val" id="utc-date">----.--.--</span></span>
      <span class="sys-sep">·</span>
      <span class="sys-item"><span class="sys-key">WEEK</span><span class="sys-val" id="week-num">--/52</span></span>
      <span class="sys-sep">·</span>
      <span class="sys-item"><span class="sys-key">NODE</span><span class="sys-val">FULLSEND-01</span></span>
    </div>

    <!-- Footer -->
    <footer class="footer-info">
      <div class="status-dot"></div>
      <span>SYSTEM ONLINE &nbsp;·&nbsp; LIVE REFRESH &nbsp;·&nbsp; RESETS SAT 12:01 AM</span>
      <button id="admin-login-btn" style="
        margin-left:auto; background:none; border:none;
        color:#1e1e40; font-size:0.55rem; letter-spacing:0.15em;
        font-family:'Orbitron',monospace; font-weight:700;
        cursor:pointer; padding:0.2rem 0.4rem; border-radius:3px;
        transition:color 0.2s;
      " onmouseover="this.style.color='#50508a'" onmouseout="this.style.color='#1e1e40'">admin</button>
    </footer>

  </main>

  <script src="dist/countdown.js"></script>

  <!-- Admin Modal -->
  <div id="admin-overlay" style="
    display:none; position:fixed; inset:0; z-index:9999;
    background:rgba(4,4,15,0.9); backdrop-filter:blur(8px);
    align-items:center; justify-content:center;
  ">
    <div style="
      background:#0e0e1e; border:1px solid #2c2c58; border-radius:10px;
      padding:1.5rem; width:min(340px,90vw);
      box-shadow:0 0 40px #7c3aed33, 0 20px 60px #00000088;
    ">
      <div style="
        font-family:'Orbitron',monospace; font-size:0.65rem;
        letter-spacing:0.25em; color:#00ffd1;
        text-shadow:0 0 8px #00ffd188; margin-bottom:1rem;
      ">// ADMIN ACCESS</div>
      <input id="admin-pass-input" type="password" placeholder="Password" autocomplete="off" style="
        width:100%; background:#141428; border:1px solid #1e1e40;
        border-radius:6px; color:#e2e2f8; padding:0.55rem 0.75rem;
        font-family:'Orbitron',monospace; font-size:0.8rem;
        letter-spacing:0.1em; outline:none; margin-bottom:0.75rem;
        transition:border-color 0.2s;
      " />
      <div id="admin-error" style="
        color:#ff006e; font-size:0.65rem; letter-spacing:0.1em;
        margin-bottom:0.75rem; display:none;
      ">incorrect password</div>
      <div style="display:flex; gap:0.5rem; justify-content:flex-end;">
        <button id="admin-cancel" style="
          background:none; border:1px solid #1e1e40; border-radius:5px;
          color:#50508a; font-size:0.75rem; padding:0.4rem 0.9rem; cursor:pointer;
        ">cancel</button>
        <button id="admin-submit" style="
          background:#7c3aed; border:none; border-radius:5px;
          color:#fff; font-size:0.75rem; font-weight:700;
          padding:0.4rem 0.9rem; cursor:pointer;
          font-family:'Orbitron',monospace; letter-spacing:0.1em;
        ">ENTER</button>
      </div>
    </div>
  </div>

  <script>
    // ── Admin login ──────────────────────────────────────────────
    const ADMIN_HASH   = '40da85184fc51b20f55e5b4236534e3806e69ca1f447d7a7c90c69ba76016fdc';
    const ADMIN_TTL_MS = 12 * 60 * 60 * 1000;
    const ADMIN_KEY    = 'fs_admin_exp';

    function setAdmin() {
      localStorage.setItem(ADMIN_KEY, (Date.now() + ADMIN_TTL_MS).toString());
    }

    async function hashInput(str) {
      const buf = await crypto.subtle.digest('SHA-256', new TextEncoder().encode(str));
      return Array.from(new Uint8Array(buf)).map(b => b.toString(16).padStart(2,'0')).join('');
    }

    document.getElementById('admin-login-btn').addEventListener('click', openAdminModal);

    const overlay  = document.getElementById('admin-overlay');
    const passInput = document.getElementById('admin-pass-input');
    const errorMsg  = document.getElementById('admin-error');

    function openAdminModal() {
      passInput.value = '';
      errorMsg.style.display = 'none';
      overlay.style.display = 'flex';
      setTimeout(() => passInput.focus(), 50);
    }
    function closeAdminModal() { overlay.style.display = 'none'; }

    async function attemptLogin() {
      const hash = await hashInput(passInput.value);
      if (hash === ADMIN_HASH) {
        setAdmin();
        closeAdminModal();
        location.href = 'community.html';
      } else {
        errorMsg.style.display = 'block';
        passInput.value = '';
        passInput.focus();
      }
    }

    document.getElementById('admin-cancel').addEventListener('click', closeAdminModal);
    document.getElementById('admin-submit').addEventListener('click', attemptLogin);
    passInput.addEventListener('keydown', e => { if (e.key === 'Enter') attemptLogin(); });
    overlay.addEventListener('click', e => { if (e.target === overlay) closeAdminModal(); });
  </script>
</body>
</html>
